sequenceDiagram
        participant Kubelet
        participant Container
        participant PreStopHook as PreStop Hook
        participant Grace as Grace Period
        
        Kubelet->>Container: Send SIGTERM
        activate Container
        
        Note right of Container: 容器开始执行停止逻辑<br/>停止接收新请求
        
        Container->>PreStopHook: Trigger PreStop execution
        activate PreStopHook
        
        Note over PreStopHook: 生命周期 Hook 执行<br/>清理、下线、刷盘、断链等
        
        PreStopHook-->>Container: Hook completed
        deactivate PreStopHook
        
        Kubelet->>Grace: Wait terminationGracePeriodSeconds
        activate Grace
        
        Note over Grace: 等待容器自行退出
        
        Grace-->>Kubelet: Timeout or exit early
        deactivate Grace
        
        alt Container not exited
            Kubelet->>Container: Send SIGKILL (force kill)
        else Container exited gracefully
            Note right of Container: 进程自行退出
        end
        
        deactivate Container